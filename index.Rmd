---
title: "Size Prediction"
description: |
  A new article created using the Radix format.
author:
  - name: Phil Nash
date: "`r Sys.Date()`"
output: radix::radix_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)


```

Hello, welcome to my project. I've used Radix to produce this, its new to me but I think its really cool. Let's get going

## Part 1: Data Exploration

I'm goign to start with some simple exploration to help understand the data a bit better

let's read in the data first:

```{r data, echo = T}
train_meta <- read_csv("./data/otb_interview_task__train__meta_time_series.csv") 
train_product <- read_csv("./data/otb_interview_task__train__product_time_series.csv") 
```


There looks to be 140 individual products:

```{r n_products, echo = T}
n_distinct(train_product$product_id)
```


Sessions looks to be rising slowe than bookings:

```{r time_series, echo = T}
train_product %>%
  group_by(date) %>% 
  summarise_at(vars(sessions, bookings), funs(sum)) %>% 
  gather(metric, value, 2:3) %>% 
  ggplot(aes(x = date, y = value)) + geom_line(aes(col = metric)) + facet_grid(rows = vars(metric), scales = "free_y")
```


Adding conversion rate confirms this. Increase in conversion rate may mean there are non media related factors driving bookings, for example a better product offering or changing mix of new vs existing customers (presumably returning customers are more likely to convert)

With this in mind I predict it will be easier to model sessions than bookings with the data we have

```{r time_series_with_conv_rate, echo = T}
train_product %>%
  group_by(date) %>% 
  summarise_at(vars(sessions, bookings), funs(sum)) %>% 
  mutate(conversion_rate = bookings / sessions) %>% 
  gather(metric, value, 2:4) %>% 
  ggplot(aes(x = date, y = value)) + geom_line(aes(col = metric)) + facet_grid(rows = vars(metric), scales = "free_y")
```


I am surprised to see so much noise in the data. When we split out each product, we can see that noise occouring across all of them

Whats also interesting here is seeing a few products increase their sessions in H2 2016 - 2018. This may be interesting in answerign the second questuion 

```{r time_series_split, echo = T}
train_product %>%
  gather(metric, value, 3:4) %>% 
  ggplot(aes(x = date, y = value, group = factor(product_id))) + geom_line(size = 0.05, alpha = 0.1) + facet_grid(rows = vars(metric), scales = "free_y")
```

Radix is a publication format for scientific and technical writing, native to the web. 

Learn more about using Radix at <https://rstudio.github.io/radix>.





